/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package som.mod.mat.form;

import java.awt.BorderLayout;
import java.util.ArrayList;
import java.util.Date;
import sa.lib.SLibConsts;
import sa.lib.db.SDbRegistry;
import sa.lib.grid.SGridColumnForm;
import sa.lib.grid.SGridConsts;
import sa.lib.grid.SGridPaneForm;
import sa.lib.gui.SGuiClient;
import sa.lib.gui.SGuiConsts;
import sa.lib.gui.SGuiUtils;
import sa.lib.gui.SGuiValidation;
import sa.lib.gui.bean.SBeanFormDialog;
import som.mod.SModConsts;
import som.mod.mat.db.SDbExwFacility;
import som.mod.mat.db.SExwStockMovement;
import som.mod.som.db.SDbItem;
import som.mod.som.db.SDbScale;
import som.mod.som.db.SDbUnit;

/**
 *
 * @author Sergio Flores
 */
public class SDialogExwStockCardex extends SBeanFormDialog {
    
    public static final int GUI_PARAMS = 1;
    
    private SDbScale moScale;
    private SDbExwFacility moExwFacility;
    private SDbItem moItem;
    private SDbUnit moUnit;
    
    private SGridPaneForm moGridRows;
    private ArrayList<SExwStockMovement> maExwStockMovements;
    
    /**
     * Creates new form SDialogExwStockCardex.
     * @param client GUI client.
     * @param formSubtype Form subtype: SViewExwStock.BY_ITEM_EXW or SViewExwStock.BY_ITEM;
     * @param title Dialog title.
     */
    public SDialogExwStockCardex(SGuiClient client, int formSubtype, String title) {
        setFormSettings(client, SGuiConsts.BEAN_FORM_EDIT, SModConsts.MX_EXW_STOCK_CARDEX, formSubtype, title);
        initComponents();
        initCustomComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The conte
     * dont of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jpRegistry = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jpData = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jlScale = new javax.swing.JLabel();
        jtfScale = new javax.swing.JTextField();
        jPanel6 = new javax.swing.JPanel();
        jlExwFacility = new javax.swing.JLabel();
        jtfExwFacility = new javax.swing.JTextField();
        jPanel7 = new javax.swing.JPanel();
        jlItem = new javax.swing.JLabel();
        jtfItem = new javax.swing.JTextField();
        jPanel15 = new javax.swing.JPanel();
        jlCutoff = new javax.swing.JLabel();
        jtfCutoff = new javax.swing.JTextField();
        jPanel2 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jlOpeningStock = new javax.swing.JLabel();
        jtfOpeningStock = new javax.swing.JTextField();
        jtfOpeningStockUnit = new javax.swing.JTextField();
        jPanel17 = new javax.swing.JPanel();
        jlInflows = new javax.swing.JLabel();
        jtfInflows = new javax.swing.JTextField();
        jtfInflowsUnit = new javax.swing.JTextField();
        jPanel14 = new javax.swing.JPanel();
        jlOutflows = new javax.swing.JLabel();
        jtfOutflows = new javax.swing.JTextField();
        jtfOutflowsUnit = new javax.swing.JTextField();
        jPanel16 = new javax.swing.JPanel();
        jlStock = new javax.swing.JLabel();
        jtfStock = new javax.swing.JTextField();
        jtfStockUnit = new javax.swing.JTextField();
        jpMovs = new javax.swing.JPanel();
        jpGrid = new javax.swing.JPanel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowActivated(java.awt.event.WindowEvent evt) {
                formWindowActivated(evt);
            }
        });

        jpRegistry.setLayout(new java.awt.BorderLayout());

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder("Existencias:")));
        jPanel1.setLayout(new java.awt.BorderLayout());

        jpData.setLayout(new java.awt.GridLayout(4, 1, 0, 5));

        jPanel4.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 5, 0));

        jlScale.setText("Báscula:");
        jlScale.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel4.add(jlScale);

        jtfScale.setEditable(false);
        jtfScale.setText("TEXT");
        jtfScale.setFocusable(false);
        jtfScale.setPreferredSize(new java.awt.Dimension(300, 23));
        jPanel4.add(jtfScale);

        jpData.add(jPanel4);

        jPanel6.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 5, 0));

        jlExwFacility.setText("Almacén externo:");
        jlExwFacility.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel6.add(jlExwFacility);

        jtfExwFacility.setEditable(false);
        jtfExwFacility.setText("TEXT");
        jtfExwFacility.setFocusable(false);
        jtfExwFacility.setPreferredSize(new java.awt.Dimension(300, 23));
        jPanel6.add(jtfExwFacility);

        jpData.add(jPanel6);

        jPanel7.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 5, 0));

        jlItem.setText("Ítem:");
        jlItem.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel7.add(jlItem);

        jtfItem.setEditable(false);
        jtfItem.setText("TEXT");
        jtfItem.setFocusable(false);
        jtfItem.setPreferredSize(new java.awt.Dimension(475, 23));
        jPanel7.add(jtfItem);

        jpData.add(jPanel7);

        jPanel15.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 5, 0));

        jlCutoff.setText("Fecha de corte:");
        jlCutoff.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel15.add(jlCutoff);

        jtfCutoff.setEditable(false);
        jtfCutoff.setText("TEXT");
        jtfCutoff.setFocusable(false);
        jtfCutoff.setPreferredSize(new java.awt.Dimension(75, 23));
        jPanel15.add(jtfCutoff);

        jpData.add(jPanel15);

        jPanel1.add(jpData, java.awt.BorderLayout.CENTER);

        jPanel2.setLayout(new java.awt.GridLayout(4, 1, 0, 5));

        jPanel5.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 5, 0));

        jlOpeningStock.setText("Inventario inicial:");
        jlOpeningStock.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel5.add(jlOpeningStock);

        jtfOpeningStock.setEditable(false);
        jtfOpeningStock.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        jtfOpeningStock.setText("0");
        jtfOpeningStock.setFocusable(false);
        jtfOpeningStock.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel5.add(jtfOpeningStock);

        jtfOpeningStockUnit.setEditable(false);
        jtfOpeningStockUnit.setText("TEXT");
        jtfOpeningStockUnit.setFocusable(false);
        jtfOpeningStockUnit.setPreferredSize(new java.awt.Dimension(35, 23));
        jPanel5.add(jtfOpeningStockUnit);

        jPanel2.add(jPanel5);

        jPanel17.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 5, 0));

        jlInflows.setText("Entradas:");
        jlInflows.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel17.add(jlInflows);

        jtfInflows.setEditable(false);
        jtfInflows.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        jtfInflows.setText("0");
        jtfInflows.setFocusable(false);
        jtfInflows.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel17.add(jtfInflows);

        jtfInflowsUnit.setEditable(false);
        jtfInflowsUnit.setText("TEXT");
        jtfInflowsUnit.setFocusable(false);
        jtfInflowsUnit.setPreferredSize(new java.awt.Dimension(35, 23));
        jPanel17.add(jtfInflowsUnit);

        jPanel2.add(jPanel17);

        jPanel14.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 5, 0));

        jlOutflows.setText("Salidas:");
        jlOutflows.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel14.add(jlOutflows);

        jtfOutflows.setEditable(false);
        jtfOutflows.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        jtfOutflows.setText("0");
        jtfOutflows.setFocusable(false);
        jtfOutflows.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel14.add(jtfOutflows);

        jtfOutflowsUnit.setEditable(false);
        jtfOutflowsUnit.setText("TEXT");
        jtfOutflowsUnit.setFocusable(false);
        jtfOutflowsUnit.setPreferredSize(new java.awt.Dimension(35, 23));
        jPanel14.add(jtfOutflowsUnit);

        jPanel2.add(jPanel14);

        jPanel16.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 5, 0));

        jlStock.setText("Existencias:");
        jlStock.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel16.add(jlStock);

        jtfStock.setEditable(false);
        jtfStock.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        jtfStock.setText("0");
        jtfStock.setFocusable(false);
        jtfStock.setPreferredSize(new java.awt.Dimension(100, 23));
        jPanel16.add(jtfStock);

        jtfStockUnit.setEditable(false);
        jtfStockUnit.setText("TEXT");
        jtfStockUnit.setFocusable(false);
        jtfStockUnit.setPreferredSize(new java.awt.Dimension(35, 23));
        jPanel16.add(jtfStockUnit);

        jPanel2.add(jPanel16);

        jPanel1.add(jPanel2, java.awt.BorderLayout.EAST);

        jpRegistry.add(jPanel1, java.awt.BorderLayout.NORTH);

        jpMovs.setLayout(new java.awt.BorderLayout());

        jpGrid.setBorder(javax.swing.BorderFactory.createTitledBorder("Movimientos:"));
        jpGrid.setLayout(new java.awt.BorderLayout());
        jpMovs.add(jpGrid, java.awt.BorderLayout.CENTER);

        jpRegistry.add(jpMovs, java.awt.BorderLayout.CENTER);

        getContentPane().add(jpRegistry, java.awt.BorderLayout.CENTER);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void formWindowActivated(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowActivated
        
    }//GEN-LAST:event_formWindowActivated

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel16;
    private javax.swing.JPanel jPanel17;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JLabel jlCutoff;
    private javax.swing.JLabel jlExwFacility;
    private javax.swing.JLabel jlInflows;
    private javax.swing.JLabel jlItem;
    private javax.swing.JLabel jlOpeningStock;
    private javax.swing.JLabel jlOutflows;
    private javax.swing.JLabel jlScale;
    private javax.swing.JLabel jlStock;
    private javax.swing.JPanel jpData;
    private javax.swing.JPanel jpGrid;
    private javax.swing.JPanel jpMovs;
    private javax.swing.JPanel jpRegistry;
    private javax.swing.JTextField jtfCutoff;
    private javax.swing.JTextField jtfExwFacility;
    private javax.swing.JTextField jtfInflows;
    private javax.swing.JTextField jtfInflowsUnit;
    private javax.swing.JTextField jtfItem;
    private javax.swing.JTextField jtfOpeningStock;
    private javax.swing.JTextField jtfOpeningStockUnit;
    private javax.swing.JTextField jtfOutflows;
    private javax.swing.JTextField jtfOutflowsUnit;
    private javax.swing.JTextField jtfScale;
    private javax.swing.JTextField jtfStock;
    private javax.swing.JTextField jtfStockUnit;
    // End of variables declaration//GEN-END:variables

    private void initCustomComponents() {
        SGuiUtils.setWindowBounds(this, 880, 550);
        
        moGridRows = new SGridPaneForm(miClient, SModConsts.MX_STK_CARDEX, SLibConsts.UNDEFINED, "Cardex de movimientos") {
            
            @Override
            public void initGrid() {
                setRowButtonsEnabled(false);
            }
            
            @Override
            public void createGridColumns() {
                int col = 0;
                SGridColumnForm[] columns = new SGridColumnForm[10];
                
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_DATE_DATETIME, "Referencia");
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_DATE, SGridConsts.COL_TITLE_DATE + " movimiento");
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_TEXT_NAME_ITM_S, "Clase movimiento", 135);
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_TEXT_REG_NUM, "Folio movimiento");
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_TEXT_NAME_ITM_S, "Estado MP", 115);
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_BOOL_S, SGridConsts.COL_TITLE_IS_SYS);
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_INT_4B, "Entrada");
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_INT_4B, "Salida");
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_INT_4B, "Existencia");
                columns[col++] = new SGridColumnForm(SGridConsts.COL_TYPE_TEXT_CODE_UNT, "Unidad", 50);
            
                for (col = 0; col < columns.length; col++) {
                    moModel.getGridColumns().add(columns[col]);
                }
            }
        };
        
        moGridRows.setForm(null);
        moGridRows.setPaneFormOwner(null);
        mvFormGrids.add(moGridRows);
        jpGrid.add(moGridRows, BorderLayout.CENTER);
        
        jbSave.setVisible(false);
        jbCancel.setText("Cerrar");
    }
    
    @Override
    public void addAllListeners() {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public void removeAllListeners() {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public void reloadCatalogues() {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public void setRegistry(SDbRegistry registry) throws Exception {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public SDbRegistry getRegistry() throws Exception {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public SGuiValidation validateForm() {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }
    
    @Override
    public void setValue(final int type, final Object value) {
        switch (type) {
            case GUI_PARAMS:
                //readParams((SGuiParams) value);
                break;
        }
    }
    
    public static class Params {
        
        public int ScaleId;
        public int ItemId;
        public int UnitId;
        public int ExwFacilityId;
        public Date Cutoff;
        
        public Params(final int scaleId, final int itemId, final int unitId, final int exwFacilityId, final Date cutoff) {
            ScaleId = scaleId;
            ItemId = itemId;
            UnitId = unitId;
            ExwFacilityId = exwFacilityId;
            Cutoff = cutoff;
        }
    }
}
